<!DOCTYPE html>
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="Campbell River Hospital Pulmonary Function Requisition eForm" />
<meta name="keywords" content="Pulmonary Function, PFT, Campbell River, CRH, NIH, North Island Hospitals, Outpatient, VIHA, Island Health, Requisition" />
<meta name="robots" content="nofollow" />
<meta http-equiv="author" content="Gunther Klein" />

<title>CRH Pulmonary Function Req</title>

<!-- v23.2.1 form built with updated background by Gunther Klein 10-Feb-2023 -->

<!-- E-FORM DISCLAIMER: 
	Licensing: This eForm was developed by Gunther Klein, and is distributed under the Creative Commons, Attribution-ShareAlike 3.0 Unported Licensse (CC BY-SA 3.0)
	As is: eForms are shared as-is, free of charge on a share-alike basis 
	with absolutely no guarantee or warranty. 
	No Quality Control: The author does not vet any eForms 
	and does not purport to apply any manner of quality control. 
	Responsibility: The responsibility for the clinical and medical-legal consequences 
	of any and all eForms, rest with the clinical OSCAR end-users themselves, not with the author of the eForm. 
	This applies to both eForms shared by others, and those created by users themselves. 
	Attribution: eForms are shared freely among the user community, 
	with attribution to the original author of the eForm. 
	Free: eForms so shared may not be sold or purchased. 
	Provincial validation:  eForms are optional and non-essential add-ons, 
	separate from OSCAR, and with their own license terms.
	eForms are not part of the OSCAR core program functionality and code base. 
	For this reason eForms are not subject to provincial validation testing and conformance criteria.
	eForms are also not subject to the ISO production process for OSCAR. -->


<style type="text/css" media="screen" >
	 .Show{
		visibility: visible;
		display: block;
	}

	 .Hide{
		visibility: hidden;
		display: none;
	}

	.DoNotPrint {
	display: block;
	}

 input {
	-moz-box-sizing: content-box;
	-webkit-print-color-adjust: exact;
	-webkit-box-sizing: content-box;
	box-sizing: content-box
 }

	 .noborder {
		border : 0px solid black;
		background-color: transparent;
		padding: 3px;
		overflow: hidden;
		font: normal 14px Arial sans-serif;
		text-align:left;
		resize:none;
	 }
	 .border {
		border : 1px solid lightgray;
		background-color: #e6f2ff;
		padding: 2px;
		overflow: hidden;
		font: normal 14px Arial sans-serif;
		text-align:left;
		resize:none;
	 }

	 .history {
		border : 1px solid lightgray;
		background-color: #e6f2ff;
		padding: 2px;
		overflow: hidden;
		font: normal 14px Arial sans-serif;
		text-align:left;
		resize:horizontal;
	 }
 .sig {
	border: 2px dotted blue;
	color: Black;
	background-color: white;
	cursor: crosshair;
 }
/* Drawing the 'gripper' for touch-enabled devices */
 html.touch #content {
	float:left;
	width:92%;
}
 html.touch #scrollgrabber {
	float:right;
	width:4%;
	margin-right:2%;
	background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAFCAAAAACh79lDAAAAAXNSR0IArs4c6QAAABJJREFUCB1jmMmQxjCT4T/DfwAPLgOXlrt3IwAAAABJRU5ErkJggg==)
 }
 html.borderradius #scrollgrabber {
	border-radius: 1em;
 }

#pg2hoverbutton {
	border: 0px solid gray;
	background-color: transparent;
	}
#pg2hoverbutton:hover {
	cursor: pointer;
	background-color: lightyellow;
	opacity: 40%;
	}
#pg2hoverbutton:active {
	cursor: pointer;
	outline: 2px solid red;
	}

	/* x-box styling - using the CSS wildcard 'containing' selector * to include all classes of x-boxes*/
	input[class*='box'] {
		position: absolute;
		width: 12px;
		height: 12px;
		font-size: 12px;
		font-family: Arial;
		border: 0.5px solid gray;
		cursor: pointer;
		font-weight: bolder;
		text-align: center;
		background-color: lightyellow;
	}
	input[class*='box']:hover {background-color: #e6f2ff;}

</style>
<style type="text/css" media="print">
	 .Show{
		visibility: visible;
		display: block;
	}
	 .Hide{
		visibility: hidden;
		display: none;
	}
      .DoNotPrint {
		display: none;
	}
 	 .noborder {
		border : 0px;
		background: transparent;
		padding: 2px;
		overflow: hidden;		
		font: normal 14px Arial sans-serif;
		text-align:left;
	 }
	 .border {
		border : 0px;
		background-color: transparent;
		padding: 2px;
		overflow: hidden;
		font: normal 14px Arial sans-serif;
		text-align:left;
	 }

	 .history {
		border : 0px solid lightgray;
		background-color: white;
		padding: 2px;
		overflow: hidden;
		font: normal 14px Arial sans-serif;
		text-align:left;
		resize:horizontal;
	 }
 .sig {
	border-style: solid;
	border-color: transparent;
	color: Black;
	background-color: transparent;
 }


	/* x-box styling - using the CSS wildcard 'containing' selector * to include all classes of x-boxes*/
	input[class*='box'] {
		position: absolute;
		width: 12px;
		height: 12px;
		font-size: 12px;
		font-family: Arial;
		border: 0.5px solid gray;
		font-weight: bolder;
		text-align: center;
		background-color: white;
	}
 </style>

<!-- jQuery for greater functionality -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script> window.jQuery || document.write('<script src="../js/jquery-1.7.1.min.js">< \/script>') </script>
<script> window.jQuery || document.write('<script src="jquery-1.7.1.min.js">< \/script>') </script>

<!-- scripts for Xbox functions -->
<script language="javascript">
$(document).ready(function() {
	$( ".Xbox" ).click(function() {
		var st = $( this ).val();
		if (st=="X") {
			$( this ).val("");
		} else {
			$( this ).val("X");
		}
	});

	$( ".Xbox" ).keypress(function(event) {
	// any key press except tab will constitute a value change to the checkbox
		if (event.which != 0){
			$( this ).click();
			return false;
			}
	});

});
</script>


<!-- jQuery for parent-child and radio fields -->
<script>
$(document).ready(function() {
	$('[class^="child-"]').hide();
	$('.parent-field').click(function() {
		$('[class^="child-"]').hide();
		$('.parent-field').each(function() {
			if ( $(this).is('input:checkbox') ){
				if(this.checked){
					$('.child-' +  $(this).prop('id')).show();
				}else{
				$('.child-' + $(this).val()).show();
				}
			}
			if ( $(this).is('input:text') ){
				if($(this).val()=='X'){
					$('.child-' +  $(this).prop('id')).show();
				}else{
				$('.child-' + $(this).val()).show();
				}
			}
		});
	});
	$('[class^="only-one-"]').click(function() {
		if ( $(this).is('input:checkbox') ){
			$('.'+$(this).attr('class')).prop('checked', false);
			$(this).prop('checked', true);
		}

		if ( $(this).is('input:text') ){
			$('.'+$(this).attr('class')).val('');
			$( this ).val('X');
		}
	});
});
</script>

<!-- Freeform Signatures -->

<script type="text/javascript" src="${oscar_javascript_path}jquery/jSignature.min.js"></script>

<!--[if lt IE 9]>
<script type="text/javascript" src="${oscar_javascript_path}flashcanvas.js"></script>
<![endif]-->

<script type="text/javascript">
jQuery(document).ready(function() {
	$("#CanvasSignature1").jSignature({'decor-color':'rgba(255, 255, 255, 0.0)'})
	var pdf = jQuery("input[name='pdfButton']");
	if (pdf.size() != 0) {
		pdf.attr('onclick', '').unbind('click');
		pdf.attr('value', 'PDF');
		pdf.click(function(){saveSig();submitPrintButton(false);});
		}
	var pdfSave = jQuery("input[name='pdfSaveButton']");
	if (pdfSave.size() != 0) {
		pdfSave.attr('onclick', '').unbind('click');
		pdfSave.attr('value', 'Submit & PDF');
		pdfSave.click(function(){saveSig();submitPrintButton(true);});
		}
})
</script>

<script type="text/javascript">
function saveSig(){
	var $sig=$("#CanvasSignature1");
	var datapair=new Array();
	datapair=$sig.jSignature("getData","base30");
	document.getElementById("StoreSignature1").value=datapair.join(",");
}
function clearSig(){
	$("#CanvasSignature1").jSignature("reset");
}
function loadSig(){
	var $sig=$("#CanvasSignature1");
	var data
	data=document.getElementById("StoreSignature1").value;
	$sig.jSignature("setData","data:"+ data) ;
}
</script>

<!-- auto ticking gender Xboxes OR checkboxes -->
<script type="text/javascript" language="javascript">
function checkGender(){
	 if (document.getElementById("PatientGender").value == "M"){
	 document.getElementById("Male").click();
	 }else if (document.getElementById("PatientGender").value == "F"){
	 document.getElementById("Female").click();
	}
 }
</script>

<script language="javascript">
function formPrint(){
	window.print();
} 
</script>


<!-- scripts to confirm closing of window if it hadnt been saved yet -->
<script language="javascript">
//keypress events trigger dirty flag
var needToConfirm = false;
document.onkeyup=setDirtyFlag;
function setDirtyFlag(){
	needToConfirm = true;
}
function releaseDirtyFlag(){
	needToConfirm = false; //Call this function to prevent an alert.
//this could be called when save button is clicked
}
window.onbeforeunload = confirmExit;
function confirmExit(){
	if (needToConfirm){
		 return "You have attempted to leave this page. If you have made any changes to the fields without clicking the Save button, your changes will be lost. Are you sure you want to exit this page?";
	 }
}
</script>


<!-- main calendar program -->
<script type="text/javascript" src="../share/calendar/calendar.js"></script>
<script type="text/javascript" src="../share/calendar/lang/calendar-en.js"></script>
<script type="text/javascript" src="../share/calendar/calendar-setup.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="../share/calendar/calendar.css" title="win2k-cold-1" />

<script type="text/javascript">
	function reImg(){
	// for stand alone development without uploading to OSCAR
		var strLoc = window.location.href.toLowerCase();
		if(strLoc.indexOf("https") == -1) {
			var src1 = document.getElementById("BGImage1").src;
			document.getElementById("BGImage1").src = src1.replace("$%7Boscar_image_path%7D","");
			var src1 = document.getElementById("BGImage2").src;
			document.getElementById("BGImage2").src = src1.replace("$%7Boscar_image_path%7D","");
		}
	}
	</script>

</head>

<body onload="checkGender();reImg();loadSig();document.FormName.RelevantHistory.focus();">
<form method="post" action="" name="FormName" id="FormName" >
<div id="page_1" class="Show" style="position:relative;"  >
<img id="BGImage1" src="${oscar_image_path}pulmonary-function-requisition-crg-nih-2023-pg1.png" style="position: relative; left: 0px; top: 0px; width:750px">


	<div id="CanvasSignature1" class="sig" style="position:absolute; left:177px; top:863px; width:232px; height:58px; z-index:10;">
	</div>
	<input type="hidden" name="StoreSignature1" id="StoreSignature1" value="">
	<input value="clear sig" name="ClearButton2" id="ClearButton2" type="button"  class="DoNotPrint" style="position:absolute; left:352px; top:930px; color:green;" onclick="clearSig();"> 


<input name="pg2hoverbutton" id="pg2hoverbutton" type="button" class="DoNotPrint" title="click to show page 2 patient instructions" style="position:absolute; left:35px; top:155px; width:270px; height:22px;" 
			onClick="
				document.getElementById('page_2').className = 'Show';
				document.getElementById('page_1').className = 'Hide';
				document.getElementById('PrintPg2Button').className = 'DoNotPrint';
			">



<input name="PatientGender" id="PatientGender" type="hidden" oscarDB=sex>
<input name="Male" id="Male" type="text" class="only-one-genderbox" style="position:absolute; left:412px; top:174px; height:6px; width:6px; font-size:8px;" >
<input name="Female" id="Female" type="text" class="only-one-genderbox" style="position:absolute; left:433px; top:174px; height:6px; width:6px; font-size:8px;" >
<input name="genderIdentity" id="genderIdentity" type="text" class=" border" style="position:absolute; left:547px; top:170px; width:88px; height:14px; " >


<input name="first_last_name" id="first_last_name" type="text" class=" noborder" style="position:absolute; left:415px; top:68px; width:286px; height:16px; font-weight:bold; "  oscarDB=first_last_name>
<input name="dobc" id="dobc" type="text" class=" noborder" style="position:absolute; left:415px; top:92px; width:122px; height:16px; "  oscarDB=dobc>
<input name="hinc" id="hinc" type="text" class=" noborder" style="position:absolute; left:415px; top:118px; width:121px; height:16px; "  oscarDB=hinc>
<input name="addressline" id="addressline" type="text" class=" noborder" style="position:absolute; left:415px; top:145px; width:290px; height:16px; "  oscarDB=addressline>
<input name="phone" id="phone" type="text" class=" noborder" style="position:absolute; left:378px; top:192px; width:123px; height:16px; font-weight:bold;"  oscarDB=phone>
<input name="cell" id="cell" type="text" class=" noborder" style="position:absolute; left:524px; top:192px; width:132px; height:16px; font-weight:bold;"  oscarDB=cell>
<input name="apptdate" id="apptdate" type="text" class="border" style="position:absolute; left:440px; top:234px; width:110px; height:16px; " >
<input name="appttime" id="appttime" type="text" class="border" style="position:absolute; left:594px; top:234px; width:63px; height:16px; " >

<input name="routine" id="routine" type="text" class="only-one-urgentbox" style="position:absolute; left:142px; top:264px; " >
<input name="urgent" id="urgent" type="text" class="only-one-urgentbox" style="position:absolute; left:209px; top:264px; " >
<input name="appttimed" id="appttimed" type="text" class="border" style="position:absolute; left:278px; top:262px; width:80px; height:14px; " >

<input name="m$HT#value" id="m$HT#value" type="text" class=" noborder" style="position:absolute; left:415px; top:262px; width:57px; height:16px; "  oscarDB=m$HT#value>
<input name="m$HT#value1" id="m$HT#value1" type="text" class=" noborder" style="position:absolute; left:584px; top:262px; width:55px; height:16px; "  oscarDB=m$HT#value>

<input name="smokingHx" id="smokingHx" type="text" class="border" style="position:absolute; left:480px; top:281px; width:215px; height:14px; " >
<input name="current_user" id="current_user" type="text" class=" noborder" style="position:absolute; left:29px; top:295px; width:325px; height:14px; font-weight:bold;"  oscarDB=current_user>
<input name="referral_name" id="referral_name" type="text" class="border" style="position:absolute; left:93px; top:315px; width:264px; height:14px; "  oscarDB=referral_name>
<input name="specialconsiderations" id="specialconsiderations" type="text" class="border" style="position:absolute; left:29px; top:357px; width:328px; height:14px; " >
<input name="infectN" id="infectN" type="text" class="only-one-infectbox" style="position:absolute; left:181px; top:381px; " >
<input name="infectY" id="infectY" type="text" class="only-one-infectbox" style="position:absolute; left:222px; top:381px; " >
<input name="infectspec" id="infectspec" type="text" class="border" style="position:absolute; left:285px; top:381px; width:72px; height:14px; " >
<input name="supplO2N" id="supplO2N" type="text" class="only-one-supplbox" style="position:absolute; left:184px; top:407px; " >
<input name="supplO2Y" id="supplO2Y" type="text" class="only-one-supplbox" style="position:absolute; left:222px; top:407px; " >
<input name="supplO2spec" id="supplO2spec" type="text" class="border" style="position:absolute; left:284px; top:407px; width:72px; height:14x; " >
<input name="allergies_des_no_archived" id="allergies_des_no_archived" type="text" class="border" style="position:absolute; left:29px; top:444px; width:328px; height:14px; "  oscarDB=allergies_des_no_archived>

<textarea name="history" id="history" type="text" class="border" style="position:absolute; left:368px; top:313px; width:327px; height:55px; " ></textarea>
<textarea name="druglist_line" id="druglist_line" type="text" class="border" style="position:absolute; left:368px; top:406px; width:327px; height:46px;"  oscarDB=druglist_line></textarea>

<input name="spirometry" id="spirometry" type="text" class="Xbox" style="position:absolute; left:33px; top:491px; " >
<input name="spirowbronchodilator" id="spirowbronchodilator" type="text" class="Xbox" style="position:absolute; left:33px; top:515px; " >
<input name="detailed" id="detailed" type="text" class="Xbox" style="position:absolute; left:33px; top:571px; " >
<input name="metacholine" id="metacholine" type="text" class="Xbox" style="position:absolute; left:33px; top:615px; " >
<input name="MIPS_MEPS" id="MIPS_MEPS" type="text" class="Xbox" style="position:absolute; left:33px; top:686px; " >
<input name="HomeO2" id="HomeO2" type="text" class="Xbox" style="position:absolute; left:33px; top:715px; " >
<input name="overnightO2" id="overnightO2" type="text" class="Xbox" style="position:absolute; left:33px; top:753px; " >

<input name="artgas" id="artgas" type="text" class="Xbox" style="position:absolute; left:33px; top:774px; " >
<input name="artgasRA" id="artgasRA" type="text" class="Xbox" style="position:absolute; left:257px; top:774px; " >
<input name="artgasO2" id="artgasO2" type="text" class="Xbox" style="position:absolute; left:329px; top:774px; " >
<input name="artgasO2flow" id="artgasO2flow" type="text" class="border" style="position:absolute; left:373px; top:772px; width:45px; height:16px; " >

<input name="SpO2rest" id="SpO2rest" type="text" class="Xbox" style="position:absolute; left:33px; top:799px; " >
<input name="sixminwalktest" id="sixminwalktest" type="text" class="Xbox" style="position:absolute; left:33px; top:823px; " >
<input name="today" id="today" type="text" class="border" style="position:absolute; left:485px; top:896px; width:134px; height:16px; text-align:center;"  oscarDB=today>

</div>
<!-- end of page 1 -->


<div id="page_2"  class="Hide" style="position:relative; width:750px; padding-top:10px;">
	<img id="BGImage2"  src=" ${oscar_image_path}pulmonary-function-requisition-crg-nih-2023-pg2.png" width="750">

	<input type="button" class="DoNotPrint"  name="PrintPg2Button" id="PrintPg2Button"   style="position:absolute; left:338px; top:47px;" value="Print page 2"
		onClick="formPrint();">
 
	<input type="button" class="DoNotPrint" name="closepg2" id="closepg2" style="position:absolute; left:680px; top:37px; color:firebrick; font:bold 18px Arial sans-serif;" value="X" title="Close Pg2"
		onClick="
			document.getElementById('page_2').className = 'Hide';
			document.getElementById('page_1').className = 'Show';
		">
</div >
<!-- end of page 2 -->

<!-- page 1 and 2 side toggle buttons -->
<div class="DoNotPrint" style="position:absolute; top:60px; left:750px;" id="togglebuttons">
	<table cellpadding="2" >
		<tr>
			<td><br><br><input name="ShowPage2" type="button" value="Show page 2" style="font-family:sans-serif; font-style:normal; font-weight:normal; font-size:10px;" 	
				onClick="
				document.getElementById('page_2').className = 'Show';
				document.getElementById('page_1').className = 'Hide';
				document.getElementById('PrintPg2Button').className = 'DoNotPrint';
			">
			</td>
		</tr>
		<tr>
			<td><input name="ShowPage2" type="button" value="Back to page 1" style="font-family:sans-serif; font-style:normal; font-weight:normal; font-size:10px;" 	
				onClick="
				document.getElementById('page_2').className = 'Hide';
				document.getElementById('page_1').className = 'Show';
			">
			</td>
		</tr>	
	</table>
</div>


<div class="DoNotPrint" id="BottomButtons" style="position: absolute; top:977px; left:10px;">
	 <table><tr><td>
		 Subject: <input name="subject" size="40" type="text"> <br> 
		<input value="Submit" name="SubmitButton" id="SubmitButton" type="submit" onclick=" saveSig(); releaseDirtyFlag();"> 
		<input value="Save Sig" name="SaveSigButton" id="SaveSigButton" type="button" onclick="saveSig();"> 
		<input value="Clear Sig" name="ClearButton" id="ClearButton" type="button" onclick="clearSig();"> 
		 <input value="Reset" name="ResetButton" id="ResetButton" type="reset"> 
			<input value="Print" name="PrintButton" id="PrintButton" type="button" onclick="formPrint();"> 
			<input value="Print & Submit" name="PrintSubmitButton" id="PrintSubmitButton" type="button" onclick="formPrint();releaseDirtyFlag();setTimeout('SubmitButton.click()',1000);">
		<br>
		<input name="AppendPage2" type="button" value="Append page 2 info to printout" 
				onClick="
				document.getElementById('page_1').className = 'Show';
				document.getElementById('page_2').className = 'Show';
				document.getElementById('PrintPg2Button').className = 'Hide';
			">
	 </td></tr></table>
	<!-- Copy Left -->
	<a rel="liscence" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US" target="blank"><img alt="Creative Commons License" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png"/></a><br>	</div>



 </form>

<!-- Define Date Calendars -->
<script type="text/javascript">
	Calendar.setup( { inputField : "apptdate", ifFormat : "%d-%b-%Y",  button : "apptdate" } );
	Calendar.setup( { inputField : "today", ifFormat : "%d-%b-%Y",  button : "today" } );
</script>

</body>
</html>
