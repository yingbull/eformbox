<!DOCTYPE html>
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8"  /> 
<meta name="description" content="FH Falls Prevention Mobile Clinic"  />
<meta name="keywords" content="Fraser Health, Falls, Prevention, Mobile, Clinic"  />
<meta name="robots" content="nofollow"  />
<meta http-equiv="author" content="John Robertson"  />
<title>FH Falls Prevention Mobile Clinic</title>

<!-- FHA Colours
Dark Blue color="#086a9d"
Light Blue color="#d3e6ef"
Orange color="#ed5714"
Light Orange color="#fbddd0"
-->

<!-- eForm DISCLAIMER: As is: eForms are shared as-is, free of charge on a share-alike basis with absolutely no guarantee or warranty.
 No Quality Control: The author does not vet any eForms and does not purport to apply any manner of quality control.
 Responsibility: The responsibility for the clinical and medical-legal consequences of any and all eForms, rest with the clinical OSCAR end-users themselves, not with the author of the eForm.
 This applies to both eForms shared by others, and those created by users themselves.
 Attribution: eForms are shared freely among the user community, with attribution to the original author of the eForm.
 Free: eForms so shared may not be sold or purchased.
 Provincial validation:  eForms are optional and non-essential add-ons, separate from OSCAR, and with their own license terms.
 eForms are not part of the OSCAR core program functionality and code base.
 For this reason eForms are not subject to provincial validation testing and conformance criteria. 
 eForms are also not subject to the ISO production process for OSCAR. -->
<!--This eForm is protected by the GNU General Public License version 2 (GPLv2)
You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously
 and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer
 to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program. -->

<!-- Do not use apostrophes - they do not allow for proper eForm zip inside Oscar.  Instead, use: &#8217; -->

<!-- Create MMSE measurement:  measurement type="MMSE" typeDesc="MMSE" typeDisplayName="MMSE" validationRule="Numeric Value: 0 to 100" -->
<!-- Create MOCA measurement:  measurement type="MOCA" typeDesc="MOCA" typeDisplayName="MOCA" validationRule="Numeric Value: 0 to 30" -->

<!--- Created 2024/01/09/ 13:40 -->
<style type="text/css" media="screen" >
 input {
	-moz-box-sizing: content-box;
	-webkit-print-color-adjust: exact;
	-webkit-box-sizing: content-box;
	box-sizing: content-box
 }
/* Drawing the 'gripper' for touch-enabled devices */
 html.touch #content {
	float:left;
	width:92%;
}
 html.touch #scrollgrabber {
	float:right;
	width:4%;
	margin-right:2%;
	background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAFCAAAAACh79lDAAAAAXNSR0IArs4c6QAAABJJREFUCB1jmMmQxjCT4T/DfwAPLgOXlrt3IwAAAABJRU5ErkJggg==)
 }
 html.borderradius #scrollgrabber {
	border-radius: 1em;
 }

	input#SubmitButton {
		color: white;
		text-shadow: 0px 1px 1px #ffffff;
		border-bottom: 2px solid #b2b2b2;
		background-color: #fbddd0;
		background: -webkit-gradient(linear, left top, left bottom, from(#fbddd0), to(#086a9d));
		background: -moz-linear-gradient(top, #fbddd0, #086a9d);
		background: -o-linear-gradient(top, #fbddd0, #086a9d);
		background: -ms-linear-gradient(top, #fbddd0, #086a9d);}
	input#SubmitButton:hover {
		color: white;
		border: 1px solid #a4a4a4;
		border-top: 2px solid #b2b2b2;
		background-color: #a0dbc4;
		background: -webkit-gradient(linear, left top, left bottom, from(#086a9d), to(#fbddd0));
		background: -moz-linear-gradient(top, #086a9d, #fbddd0);
		background: -o-linear-gradient(top, #086a9d, #fbddd0);
		background: -ms-linear-gradient(top, #086a9d, #fbddd0);}

	input#PrintButton {
		color: black;
		text-shadow: 0px 1px 1px #ffffff;
		border-bottom: 2px solid #b2b2b2;
		background-color: #fbddd0;
		background: -webkit-gradient(linear, left top, left bottom, from(#fbddd0), to(#d3e6ef));
		background: -moz-linear-gradient(top, #fbddd0, #d3e6ef);
		background: -o-linear-gradient(top, #fbddd0, #d3e6ef);
		background: -ms-linear-gradient(top, #fbddd0, #d3e6ef);}
	input#PrintButton:hover {
		color: black;
		border: 1px solid #a4a4a4;
		border-top: 2px solid #b2b2b2;
		background-color: #a0dbc4;
		background: -webkit-gradient(linear, left top, left bottom, from(#d3e6ef), to(#fbddd0));
		background: -moz-linear-gradient(top, #d3e6ef, #fbddd0);
		background: -o-linear-gradient(top, #d3e6ef, #fbddd0);
		background: -ms-linear-gradient(top, #d3e6ef, #fbddd0);}

.attn{
  animation-name: lookHere;
  animation-duration: 5s;
  animation-timing-function: linear;
  animation-iteration-count: 3;
  animation-direction: alternate;
}

@keyframes lookHere {
  0%   {border-color:#fbddd0;
box-shadow: 0 0 5px #fbddd0;}
  25%  {border-color:#ed5714;
box-shadow: 0 0 20px #ed5714;}
  50%  {border-color:#086a9d;
box-shadow: 0 0 5px #086a9d;}
  75%  {border-color:#d3e6ef;
box-shadow: 0 0 20px #d3e6ef;}
  100% {border-color:#fbddd0;
box-shadow: 0 0 5px #fbddd0;}
}
  textarea {
    resize: none;
}
.link {  
 border:2px solid #000000;
border-color:#d3e6ef;
 border-style:outset;
background:transparent;
text-decoration: none;
 cursor: pointer;
}

 .link:hover {
 border:1px solid #000000;
 border-style:outset;
 background:#086a9d;
 opacity:0.4;
 color:#d3e6ef;
 }

 .link:active { 
 border:3px solid #000000; 
 border-style:inset;
 background:#d3e6ef;
 }
	#Sidepanel {
		position:absolute; 
		left:755px; 
		top:50px; 
		min-width: 500px; 
		width: auto;
		height: auto; 
		padding:2px 4px 5px; 
		background:#eeeeee; 
		border:3px solid #4984b4;
	}
::placeholder {
	color: #ed5714;
	font-style: italic;
	opacity: 1;}
.noborder {
    border: 1px solid #d2d2d2 !important;
}

input:invalid {
    background-color: ivory;
    border: none;
    outline: 1px solid red;
}

</style>

<style type="text/css" media="print">
 .DoNotPrint {
	 display: none;
 }
 .DoNotPrint2 {
	 display: none;
 }
 .noborder {
	 border : 0px;
	 background: transparent;
	 scrollbar-3dlight-color: transparent;
	 scrollbar-3dlight-color: transparent;
	 scrollbar-arrow-color: transparent;
	 scrollbar-base-color: transparent;
	 scrollbar-darkshadow-color: transparent;
	 scrollbar-face-color: transparent;
	 scrollbar-highlight-color: transparent;
	 scrollbar-shadow-color: transparent;
	 scrollbar-track-color: transparent;
	 background: transparent;
	 overflow: hidden;
 }
  textarea {
    resize: none;
}
/* hide placeholders on print */
::placeholder {
	color: transparent;
} 

</style>

<!-- style script for the accordion boxes -->
<style>
	.accordion {
		background-color: #fbddd0;
		color: #ed5714;
		cursor: pointer;
		padding: 12px;
		width: 100%;
		border: none;
		text-align: left;
		outline: none;
		font-size: 14px;
		font-weight: bold;
		transition: 0.6s;
	}

	.active, .accordion:hover {
		background-color: #086a9d;
		font-weight: bold;
		color: #fbddd0;
	}

	.accordion:after {
		content: '\002B';
		color: #ed5714;
		float: right;
		margin-left: 5px;
	}

	.active:after {
		content: "\2212";
	}

	.panel {
		padding: 0 18px;
		background-color: #F8F8F8;
		border: 1px solid lightgrey;
		max-height: 0;
		overflow: hidden;
		transition: max-height 0.7s ease-out;
	}
</style>

<!-- jQuery for greater functionality -->
<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.1.min.js" integrity="sha256-gvQgAFzTH6trSrAWoH1iPo9Xc96QxSZ3feW6kem+O00=" crossorigin="anonymous" ></script>
<script> window.jQuery || document.write('<script src="../js/jquery-1.7.1.min.js">< \/script>') </script>
<script>
if (typeof jQuery === 'undefined') {
	document.write(unescape('%3Cscript%20src%3D%22../js/jquery-1.7.1.min.js%22%3E%3C/script%3E'));
}
</script>
<!-- script to link to other pages -->
<script language="javascript" src="${oscar_image_path}onBodyLoad_Oct2018.js"></script>
<script language="javascript1.2" type="text/javascript" src="onBodyLoad_Oct2018.js"></script>
 <!-- js graphics scripts -->
<script type="text/javascript" src="${oscar_image_path}jsgraphics.js"></script>

	<link rel="stylesheet" type="text/css" href="${oscar_image_path}JSMPC.css" />

<script language="javascript" type="text/javascript">
		/****************************
		startup functions 
		****************************/
		function startUp()
		{			
			setDocumentTitle('FH Falls Prevention Mobile Clinic',document.getElementById('patient_nameL').value);
			reImg();
			setFaxNo();
			setDefaults();
			//optimize window size/width
			top.window.resizeTo(900, screen.availHeight);
		}
		
		function setDocumentTitle(Title,patient_nameL)
		{
			// set document title
			document.title = Title + ' - ' + patient_nameL;					
							
		}
	function setDefaults() {
		// check the newform flag to ensure this is the initial load of the form 
		if (document.getElementById("newForm").value == 'True') {
			document.getElementById('Same').click();
			document.getElementById('Referral_MD').click();
			document.getElementById('Site_FP').click();
			parseDate('today',0,1,2,'-','/');
			checkGender();
			validateTestResults();
		} else { // actions if eForm is reopened
			loadSig();
			reloadSignature();  // Determine submitted signature state on reload
		}
	}

	/****************************
		Create date in dd/mm/yyyy format; 
		Oscar default is yyyy-mm-dd
	****************************/

function parseDate(id, x, y, z, D, d) {
	// Now included code to remove time from dates
    // Change date field to dd/mmm/yyyy format
	//The element that you want to change is passed via the id
	// If the initial order is  YYYY  MM  DD then x should be 0,y should be 1, and z should be 2
	// If the initial order is  DD  MM and YYYY then x should be 2,y should be 1, and z should be 0
	// Delimiter (between the digits for day month and year) is passed as D - usually either a "-"  or a "/"
	// Output Delimiter (between the digits for day month and year) is passed as d - usually either a "-"  or a "/"
    // Get the date
    var fullMeasurementDate = $("#" + id).val();
    var fullDate = fullMeasurementDate.split(' ')[0];

    if (fullDate) {
    // Split the value
        var year = fullDate.split(D)[x];
        var monthNum = fullDate.split(D)[y];
        var monthNumArray = monthNum - 1;
        var day = fullDate.split(D)[z];
	// Convert Numeric Month to 3 letter month using toLocaleString
        var date = new Date(year, monthNumArray, day);
        var month = date.toLocaleString('default', { month: 'short' });
        var mixedDate = day + d + month + d + year;
        var numericDate = day + d + monthNum + d + year;
    // Show the fields on the page
    //  $("#" + id).val(mixedDate);
        $("#" + id).val(numericDate);
    } else {
        $("#" + id).attr("placeholder", "click for date");
    }
}
//keypress events trigger dirty flag
var needToConfirm = false;
document.onkeyup=setDirtyFlag;
function setDirtyFlag(){
	needToConfirm = true;
}
	/****************************
		Check MoCA and MMSE results
	****************************/

function validateTestResults() {
  // Get input values
  var mocaInput = document.getElementById("MoCA").value;
  var mmseInput = document.getElementById("MMSE").value;

  // Check if MoCA is empty
  if (mocaInput === "") {
    alert("Please give a result for the MoCA test");
    return;
  }

  // Check if MMSE is empty
  if (mmseInput === "") {
    alert("Please give a result for the MMSE test");
    return;
  }

  // Check MoCA score eligibility
  var mocaScore = parseInt(mocaInput, 10);
  if (mocaScore <= 19) {
    alert("The MoCA score is 19 or less, and this patient is not eligible");
    return;
  }

  // Check MMSE score eligibility
  var mmseScore = parseInt(mmseInput, 10);
  if (mmseScore <= 24) {
    alert("The MMSE score is 24 or less, and this patient is not eligible");
    return;
  }
}

function releaseDirtyFlag(){
	needToConfirm = false; //Call this function to prevent an alert.
//this could be called when save button is clicked
}
window.onbeforeunload = confirmExit;
function confirmExit(){
	if (needToConfirm){
		 return "You have attempted to leave this page. If you have made any changes to the fields without clicking the Save button, your changes will be lost. Are you sure you want to exit this page?";
	 }
}

	/****************************
		print and submit/save functions 
	****************************/
	function printLetter() {
		// Save reminder; allows for validity testing
		document.getElementById('SubmitButton').classList.toggle('attn');
		document.getElementById('ResetButton').style.color = 'black';
		document.getElementById('SubmitButton').style.border = '2px solid red';
		alert("eFORM has NOT been submitted.  If needed, cancel print and complete required fields.  Ensure you click SUBMIT after print.");
		window.print();
	}

	function submission() {  // requires type="submit" in submit button input to allow for validity testing
		setFlag();
		releaseDirtyFlag();
	}

	function setFlag() {
	// indicate that the form has been submitted
	if (document.getElementById("newForm").value == 'True')
		document.getElementById("newForm").value = 'False';
	}
</script>
<!-- auto ticking gender Xboxes OR checkboxes -->
<script type="text/javascript" language="javascript">
function checkGender(){
	 if (document.getElementById('PatientGender').value == 'M'){
	 document.getElementById('Gender_1').click();
	 }else if (document.getElementById('PatientGender').value == 'F'){
	 document.getElementById('Gender_2').click();
	}
 }
</script>
	<!-- Xbox styling -->

	<style type="text/css">
	/* x-box styling - using the CSS wildcard 'containing' selector * to include all classes of x-boxes*/
	input[class*='box'] {
		position: absolute;
		font-family: Arial;
		border: 1px solid black;
		cursor: pointer;
		font-weight: bolder;
		text-align: center;
		background: #d3e6ef;
	}
	input[class*='box']:hover {
		color: #086a9d;
		border: 1px solid #a4a4a4;
		border-top: 2px solid #b2b2b2;
		background-color: #fbddd0;
		background: -webkit-gradient(linear, left top, left bottom, from(#d3e6ef), to(#fbddd0));
		background: -moz-linear-gradient(top, #d3e6ef, #fbddd0);
		background: -o-linear-gradient(top, #d3e6ef, #fbddd0);
		background: -ms-linear-gradient(top, #d3e6ef, #fbddd0);
		}
.box1 {
		font-size: 12px;
		width:12px;
		height:12px;
		}
	</style>

    <script language="javascript">
function reImg(){
// for stand alone development without uploading to OSCAR
	var strLoc = window.location.href.toLowerCase();
	if(strLoc.indexOf("https") == -1) {
		var src1 = document.getElementById("BGImage1").src;
		document.getElementById("BGImage1").src = src1.replace("$%7Boscar_image_path%7D","");
	}
}
</script>

<script type="text/javascript" src="${oscar_javascript_path}eforms/printControl.js"></script>
<script type="text/javascript" src="${oscar_javascript_path}eforms/faxControl.js"></script>

<script language="javascript">
function setFaxNo(){

	setTimeout(function() {
	$('#faxSave_button').css("background-color", "yellow");
	$('#fax_button').hide();
	document.getElementById("otherFaxInput").value="16045202154"
	AddOtherFax();
	return false;
	   },1000);

   
	  setTimeout(function() {
	   $('#otherFaxSelect').prepend('<option value="16045202154">Falls Prevention Mobile Clinic</option>');
	   $('select option[value="16045202154"]').attr("selected",true);
	   //$('#faxSave_button').css("background-color", "yellow");
	   //AddOtherFaxProvider();
	   return false;
             },500);

} 
	/****************************
		Copy to Clipboard
	****************************/
	$(document).ready(function() {
		var y = document.getElementsByClassName('copyable');
		$(y).click(function() {
		this.select();
		document.execCommand('copy');
		$(this).css('background-color', '#ccb796').fadeIn("slow");
		$(this).css('opacity', '0.4');
		})
	})
</script>

<!-- main calendar program -->
<script type="text/javascript" src="../share/calendar/calendar.js"></script>
<script type="text/javascript" src="../share/calendar/lang/calendar-en.js"></script>
<script type="text/javascript" src="../share/calendar/calendar-setup.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="../share/calendar/calendar.css" title="win2k-cold-1" />

</head>

<body onload="startUp();" >
<form method="post" action="" name="FormName" id="FormName" >
<div id="page1" style="position:relative;" >
<img id='BGImage1' src="${oscar_image_path}FPMC-Referral-Form-1.png" style="position: absolute; left: 0px; top: 0px; width:750px">
<!-- Hidden Inputs -->
<input name="PatientGender" id="PatientGender" type="hidden" oscarDB=sex />
<!-- end Hidden Inputs --> 
<textarea name="PtLabel" class="noborder" style="position: absolute; left:445px; top:5px; width:285px; height:165px; font-family:sans-serif; font-style:normal; font-weight:normal; font-size:14px; background-color:transparent;" oscarDB=label ></textarea>
<span style="position: absolute; left:472px; top:215px; color:#086a9d;"><input name="FPMCFax" id="FPMCFax" type="text" class="DoNotPrint2 link copyable" value="16045202154" style="width:85px; height:14px; color:transparent " />click to copy</span>
<a class="DoNotPrint2 link" style="position:absolute; left:290px; top:230px; height:16px; width:395px;" href="https://pulse/clinical/quality-patient-safety/Pages/Falls-prevention-mobile-clinic.aspx" target="_blank" title="This link will only open inside the Fraser Health network" ></a>
<div class="DoNotPrint2" style="position:absolute; left:690px; top:230px; color:#086a9d;">Link only works inside FH</div>
<input name="Non-Amb" id="Non-Amb" type="text"  class="Xbox box1"  style="left:32px; top:265px;" >
<input name="LTC" id="LTC" type="text"  class="Xbox box1"  style="left:32px; top:280px;" >
<input name="CogImp" id="CogImp" type="text"  class="Xbox box1"  style="left:32px; top:295px;" >
<input name="Directions" id="Directions" type="text"  class="Xbox box1"  style="left:32px; top:310px;" >
<!-- Referral Info -->
<input name="today" id="today" type="text" class="noborder" style="position:absolute; left:210px; top:339px; width:150px; font-family:sans-serif; font-style:normal; font-weight:normal; font-size:14px; text-align:left; background-color:transparent;"  oscarDB=today>
<input name="current_user" id="current_user" type="text" class=" noborder" style="position:absolute; left:20px; top:370px; width:235px; font-family:sans-serif; font-style:normal; font-weight:normal; font-size:14px; text-align:left; background-color:transparent;"  oscarDB=current_user />
<input name="clinic_phone" id="clinic_phone" type="text" class="noborder" style="position:absolute; left:80px; top:392px; width:175px; font-size:14px; background-color:transparent; "  oscarDB=clinic_phone />
<input name="clinic_fax" id="clinic_fax" type="text" class="noborder" style="position:absolute; left:65px; top:416px; width:190px; font-size:14px; background-color:transparent; "  oscarDB=clinic_fax />
<input name="Referral_Self" id="Referral_Self" type="text" class="Radio box1" style="left:345px; top:359px; " onmouseup="getElementById('Referral_OTH_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Referral_MD" id="Referral_MD" type="text" class="Radio box1" style="left:345px; top:375px; " onmouseup="getElementById('Referral_OTH_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Referral_RN" id="Referral_RN" type="text" class="Radio box1" style="left:495px; top:359px; " onmouseup="getElementById('Referral_OTH_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Referral_SW" id="Referral_SW" type="text" class="Radio box1" style="left:495px; top:375px; " onmouseup="getElementById('Referral_OTH_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Referral_PT" id="Referral_PT" type="text" class="Radio box1" style="left:636px; top:359px; " onmouseup="getElementById('Referral_OTH_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Referral_OTH" id="Referral_OTH" type="text" class="Radio box1" style="left:636px; top:375px; " onmouseup="getElementById('Referral_OTH_Text').required=true ; document.forms['FormName'].checkValidity();" />
<input name="Referral_OTH_Text" id="Referral_OTH_Text" type="text" class=" noborder" style="position:absolute; left:693px; top:372px; width:34px; font-family:sans-serif; font-size:14; background-color:transparent;" />
<input name="Site_FP" id="Site_FP" type="text" class="Radio box1" style="left:345px; top:392px; " onmouseup="getElementById('Site_OTH_Text').required=false ; getElementById('HH').value='' ; getElementById('SSC').value='' ; document.forms['FormName'].checkValidity();" />
<input name="Site_ED" id="Site_ED" type="text" class="Radio box1" style="left:345px; top:408px; " onmouseup="getElementById('Site_OTH_Text').required=false ; getElementById('HH').value='' ; getElementById('SSC').value='' ; document.forms['FormName'].checkValidity();" />
<input name="Site_KC" id="Site_KC" type="text" class="Radio box1" style="left:495px; top:392px; " onmouseup="getElementById('Site_OTH_Text').required=false ; getElementById('HH').value='' ; getElementById('SSC').value='' ; document.forms['FormName'].checkValidity();" />
<input name="Site_SSC" id="Site_SSC" type="text" class="Radio box1" style="left:495px; top:408px; " onmouseup="getElementById('Site_OTH_Text').required=false ; getElementById('SSC').click() ; getElementById('HH').value='' ; document.forms['FormName'].checkValidity();" />
<input name="Site_HH" id="Site_HH" type="text" class="Radio box1" style="left:636px; top:392px; " onmouseup="getElementById('Site_OTH_Text').required=false ; getElementById('HH').click() ; getElementById('SSC').value='' ; document.forms['FormName'].checkValidity();" />
<input name="Site_OTH" id="Site_OTH" type="text" class="Radio box1" style="left:636px; top:408px; " onmouseup="getElementById('Site_OTH_Text').required=true ; getElementById('HH').value='' ; getElementById('SSC').value='' ; document.forms['FormName'].checkValidity();" />
<input name="Site_OTH_Text" id="Site_OTH_Text" type="text" class=" noborder" style="position:absolute; left:630px; top:422px; width:97px; font-family:sans-serif; font-size:14; background-color:transparent;" />
<!-- Patient Information -->
<input name="patient_nameF" id="patient_nameF" type="text" class=" noborder" style="position:absolute; left:95px; top:460px; width:265px; font-family:sans-serif; font-size:14; background-color:transparent;" oscarDB=patient_nameF />
<input name="patient_nameL" id="patient_nameL" type="text" class=" noborder" style="position:absolute; left:95px; top:486px; width:265px; font-family:sans-serif; font-size:14; background-color:transparent;" oscarDB=patient_nameL />
<input name="hinc" id="hinc" type="text" class="noborder" style="position:absolute; left:58px; top:512px; width:302px; font-size:14px; background-color:transparent; "  oscarDB=hinc />
<textarea name="address" class="noborder" style="position: absolute; left:370px; top:473px; width:355px; height:55px; font-family:sans-serif; font-style:normal; font-weight:normal; font-size:14px; background-color:transparent;" oscarDB=address ></textarea>
<input name="dobc" id="dobc" type="text" class=" noborder" style="position:absolute; left:160px; top:536px; width:200px; font-family:sans-serif; background-color:transparent; font-size:14;" oscarDB=dobc />
<input name="Gender_1" id="Gender_1" type="text" class="Radio box1" style="left:109px; top:566px;" />
<input name="Gender_2" id="Gender_2" type="text" class="Radio box1" style="left:184px; top:566px;" />
<input name="Gender_3" id="Gender_3" type="text" class="Radio box1" style="left:271px; top:566px;" />
<span style="position:absolute; left:125px; top:591px; " >H:<input name="phone" id="phone" type="text" class="noborder" style="width:95px; font-size:12px; background-color:transparent; "  oscarDB=phone />
C: <input name="cell" id="cell" type="text" class="noborder" style="width:95px; font-size:12px; background-color:transparent; "  oscarDB=cell />
</span>
<input name="Language" id="Language" type="text" class=" noborder" style="position:absolute; left:490px; top:535px; width:235px; font-family:sans-serif; font-size:14; background-color:transparent;" />
<input name="Translator_Yes" id="Translator_Yes" type="text" class="Radio box1" style="left:523px; top:565px; "  onmouseup="getElementById('Language').required=true ; document.forms['FormName'].checkValidity();" />
<input name="Translator_No" id="Translator_No" type="text" class="Radio box1" style="left:586px; top:565px; "  onmouseup="getElementById('Language').required=false ; document.forms['FormName'].checkValidity();" />
<input name="email" id="email" type="text" class="noborder" style="position:absolute; left:415px; top:591px; width:310px; font-size:14px; background-color:transparent; "  oscarDB=email />
<input name="Same" id="Same" type="text"  class="Xbox box1"  style="left:33px; top:623px;" >
<input name="doctor" id="doctor" type="text" class=" noborder" style="position:absolute; left:395px; top:608px; width:330px; font-family:sans-serif; font-style:normal; font-weight:normal; font-size:12px; text-align:left; background-color:transparent;"  oscarDB=doctor />
<input name="clinic_addressLineFull" id="clinic_addressLineFull" type="text" class=" noborder" style="position:absolute; left:395px; top:626px; width:330px; font-family:sans-serif; font-style:normal; font-weight:normal; font-size:12px; text-align:left; background-color:transparent;"  oscarDB=clinic_addressLineFull />
<!-- Alternative Contact -->
<input name="Alternative" id="Alternative" type="text"  class="Xbox box1"  style="left:172px; top:643px;" >
<input name="Relationship" id="Relationship" type="text" class=" noborder" style="position:absolute; left:150px; top:660px; width:245px; font-family:sans-serif; font-size:14; background-color:transparent;" />
<input name="RelationPhone" id="RelationPhone" type="text" class=" noborder" style="position:absolute; left:500px; top:660px; width:225px; font-family:sans-serif; font-size:14; background-color:transparent;" />
<!-- Medical History -->
<input name="MedList" id="MedList" type="text"  class="Xbox box1"  style="left:24px; top:682px;" >

<div id="ChartLinks" class="DoNotPrint2" style="position: absolute; left:740px; top:680px; font-size:14px;" >
	<input value="To Medications" name="Rx_module" type="button" class="link" onclick="onBodyLoad(); Rx();" /><br>
	<input name="MoCA_Link" id="MoCA_Link" type="button" class="link" oscarOPEN="MoCA" title="to MoCA eForm - legacy" value="MOCA eForm - Legacy"/><br>
	<a name="Website1" class="link" style="color:#086a9d;" href="https://www.mocatest.org/the-moca-test/" target="_blank" title="Web reference">MoCA website</a><br>
	<input name="MMSE_Link" id="MMSE_Link" type="button" class="link" oscarOPEN="MMSE" title="to MMSE eForm" value="MMSE eForm" /><br>
	<a name="Website2" class="link" style="color:#086a9d;" href="https://www2.gov.bc.ca/gov/content/health/practitioner-professional-resources/bc-guidelines/cognitive-impairment" target="_blank" title="Web reference">Gov BC version</a><br>
	<span style="color:#086a9d;" class="DoNotPrint" >(import missing MMSE eForm <a target="_blank" style="text-decoration:underline;" href="https://oscargalaxy.org/download/standardized-mini-mental-state-exam-mmse/">here </a>)</span>
</div>
<input name="Falls" id="Falls" type="text" class=" noborder" style="position:absolute; left:630px; top:700px; width:95px; font-family:sans-serif; font-size:14; background-color:transparent;" />
<input name="COPD" id="COPD" type="text" class="Xbox box1" style="left:24px; top:719px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Stenosis" id="Stenosis" type="text" class="Xbox box1" style="left:24px; top:744px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Stroke" id="Stroke" type="text" class="Xbox box1" style="left:24px; top:771px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Vertigo" id="Vertigo" type="text" class="Xbox box1" style="left:148px; top:719px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Cancer" id="Cancer" type="text" class="Xbox box1" style="left:148px; top:744px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="MS" id="MS" type="text" class="Xbox box1" style="left:148px; top:771px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="ChronicPain" id="ChronicPain" type="text" class="Xbox box1" style="left:236px; top:719px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Pacemaker" id="Pacemaker" type="text" class="Xbox box1" style="left:236px; top:744px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="HD" id="HD" type="text" class="Xbox box1" style="left:236px; top:771px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Bone" id="Bone" type="text" class="Xbox box1" style="left:345px; top:719px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="KD" id="KD" type="text" class="Xbox box1" style="left:345px; top:744px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Parkinsons" id="Parkinsons" type="text" class="Xbox box1" style="left:345px; top:771px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="DM" id="DM" type="text" class="Xbox box1" style="left:478px; top:719px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Neuropathy" id="Neuropathy" type="text" class="Xbox box1" style="left:478px; top:744px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Anxiety" id="Anxiety" type="text" class="Xbox box1" style="left:478px; top:771px;" onmouseup="getElementById('Other_Text').required=false ; document.forms['FormName'].checkValidity();" />
<input name="Arthritis" id="Arthritis" type="text" class="Xbox box1" style="left:640px; top:719px;" onmouseup="getElementById('Other_Text').required=true ; document.forms['FormName'].checkValidity();" />
<input name="Other" id="Other" type="text" class="Xbox box1" style="left:640px; top:744px;" onmouseup="getElementById('Other_Text').required=true ; document.forms['FormName'].checkValidity();" />
<input name="Other_Text" id="Other_Text" type="text" class="noborder" style="position:absolute; left:625px; top:777px; width:100px; font-size:14px; background:transparent;" />

<input name="Cog_yes" id="Cog_yes" type="text" class="Radio box1" style="left:24px; top:836px;" />
<input name="Cog_no" id="Cog_no" type="text" class="Radio box1" style="left:79px; top:836px;" />
<input name="Cog_unsure" id="Cog_unsure" type="text" class="Radio box1" style="left:125px; top:836px;" />
<!-- Diagnostic Tests (Cognitive) -->
<input name="MoCA" id="MoCA" type="text" class="noborder" style="position:absolute; left:510px; top:837px; width:45px; font-size:14px; background:transparent;" oscarDB=m$MOCA#value onblur="validateTestResults();"   />
<input name="MMSE" id="MMSE" type="text" class="noborder" style="position:absolute; left:650px; top:837px; width:40px; font-size:14px; background:transparent;" oscarDB=m$MMSE#value onblur="validateTestResults();"   />
<!-- ADL -->
<input name="ADL_No" id="ADL_No" type="text" class="Radio box1" style="left:343px; top:860px;" />
<input name="ADL_Mild" id="ADL_Mild" type="text" class="Radio box1" style="left:343px; top:876px;" />
<input name="ADL_Mod" id="ADL_Mod" type="text" class="Radio box1" style="left:513px; top:860px;" />
<input name="ADL_Severe" id="ADL_Severe" type="text" class="Radio box1" style="left:513px; top:876px;" />
<!-- Clinical Frailty Score -->
<span style="position:absolute; left:25px; top:917px; color:#086a9d;font-size:10px;" class="DoNotPrint2"><input name="Menu_Link" id="Menu_Link" type="button" class="link" style="width:120px; height:14px; background:transparent;" onclick="getElementById('Frailty').click() ;" /><br>
Click above to open/close side menu</span>
<input name="CFS_1" id="CFS_1" type="text" class="Radio box1" style="left:202px; top:895px;" />
<input name="CFS_2" id="CFS_2" type="text" class="Radio box1" style="left:202px; top:914px;" />
<input name="CFS_3" id="CFS_3" type="text" class="Radio box1" style="left:202px; top:933px;" />
<input name="CFS_4" id="CFS_4" type="text" class="Radio box1" style="left:342px; top:895px;" />
<input name="CFS_5" id="CFS_5" type="text" class="Radio box1" style="left:342px; top:914px;" />
<input name="CFS_6" id="CFS_6" type="text" class="Radio box1" style="left:342px; top:933px;" />
<input name="CFS_7" id="CFS_7" type="text" class="Radio box1" style="left:512px; top:895px;" />
<input name="CFS_8" id="CFS_8" type="text" class="Radio box1" style="left:512px; top:914px;" />
<input name="CFS_9" id="CFS_9" type="text" class="Radio box1" style="left:512px; top:933px;" />
<!-- Current Services -->
<input name="HH" id="HH" type="text" class="Xbox box1" style="left:202px; top:952px;" />
<input name="SSC" id="SSC" type="text" class="Xbox box1" style="left:342px; top:952px;" />
<input name="MH" id="MH" type="text" class="Xbox box1" style="left:512px; top:952px;" />
</div>

 <!-- The submit/print/reset buttons ------------------------------------------------------------->
 <div class="DoNotPrint" id="BottomButtons" style="position: absolute; top:980px; left:0px;">
	 <table ><tr style="background-color:transparent;"><td style="background-color:transparent;">
		<input type="hidden" name="newForm" id="newForm" value="True"  />
		Subject: <input name="subject" size="40" type="text"> <br> 
		<input value="Reset" name="ResetButton" id="ResetButton" type="reset" style="color:red;" onclick="history.go(0);" /> 
		<input value="Print" name="PrintButton" id="PrintButton" type="button" onclick="printLetter();" /> 
		<input value="Submit" name="SubmitButton" id="SubmitButton" type="submit" onclick="submission();" />
	 </td></tr></table>

<!-- Copy Left -->
<span>Created January 13<sup>th</sup> 2024<a href="https://giphy.com/gifs/oaeW0jroP1KR5C7cjD/html5" target="_blank">Dr. John Robertson</a>, </span> 
licensed under the <a rel="license" href="https://www.gnu.org/licenses/old-licenses/gpl-2.0.html" target="_blank">GNU General Public License, version 2(GPLv2)</a><br>
<span style="color:forestgreen;">Please consider supporting </span><a href="https://oscarbc.ca/" target="_blank">oscarbc.ca.</a> |
<a id="emailLnk1" style="cursor:pointer;" onclick="javascript:window.open('mailto:info@oscarbc.ca', 'mail'); event.preventDefault();" title="Email to OSCAR BC">Email: info@oscarbc.ca/</a> |
<a href="https://www.facebook.com/pg/OSCARBCcommunity" target="_blank">Facebook</a> | 
<a href="https://twitter.com/OSCARBCemr" target="_blank">Twitter</a> | 
<a href="https://www.linkedin.com/company/oscarbc/" target="_blank">LinkedIn</a> |
<br><br>
 </div>
 </form>
<!-- Order Sets -->
<div id="Sidepanel" class="DoNotPrint2">
For questions: Email: <a id="emailLnk" style="height:16px; color:#746557; " class="DoNotPrint2 link" onclick="javascript:window.open('mailto:fallsprevention@fraserhealth.ca?Subject=Referral%20to%20The%20Fraser%20Health%20Falls%20Prevention%20Program&body= Please see the attached referral to the Fraser Health Falls Prevention Program'); event.preventDefault();" title="email to Fraser Health Falls Prevention">fallsprevention@fraserhealth.ca</a><br>
  Telephone: 604-587-7866<br>
For more information on Medications and Falls Risk, please visit:
<a class="DoNotPrint2 link" href="https://findingbalancebc.ca/wp-content/uploads/2017/10/Medications-and-the-Risk-of-Falling-2017-FINAL.pdf" target="_blank" >https://findingbalancebc.ca/wp-content/uploads/2017/10/Medications-and-the-Risk-of-Falling-2017-FINAL.pdf</a>
<button class="accordion" id="Frailty">Clinical Frailty Scale</button>
<div id="Scale" class="DoNotPrint2 panel" >
	<span name="Scale" class="DoNotPrint2" style="width:250px; font-size:14px; color:#086a9d;" >
	Also consider using the Clinical Frailty eForm <input name="CFS_Link" id="CFS_Link" type="button" class="link" oscarOPEN="Clinical Frailty Scale" title="to Clinical Frailt Scale eForm" value="CFS eForm">
	<span style="color:#086a9d;" class="DoNotPrint" >(import missing CFS eForm <a target="_blank" style="text-decoration:underline;" href="https://oscargalaxy.org/download/clinical-frailty-scale/">here </a>)</span><br><br>
	1 - Very Fit – People who are robust, active, energetic and motivated. These People commonly exercise regularly. They are among the fittest for their age.<br>
	2 - Well – People who have no active disease symptoms but are less fit than Category 1. Often, they exercise or are very active occasionally, e.g. seasonally.<br>
	3 - Managing Well – People whose medical problems are well controlled, but are not regularly active beyond routine walking.<br>
	4 - Vulnerable – While not dependent on others for daily help, often symptoms limit activities. A common complaint is being "slowed up", and/or being tired during the day.<br>
	5 - Mildly Frail – These people often have more evident slowing, and need help in high order IADLs (finances, transportation, heavy housework, medications). Typically, mild frailty progressively impairs shopping and walking outside alone, meal preparation and housework.<br>
	6 - Moderately Frail – People need help with all outside activities and with keeping house. Inside, they often have problems with stairs and need help with bathing and might need minimal assistance (cuing, standby) with dressing.<br>
	7 - Severely Frail – Completely dependent for personal care, from whatever cause (physical or cognitive). Even so, they seem stable and not at high risk of dying (within ~ 6 months).<br>
	8 - Very Severely Frail – Completely dependent, approaching the end of life. Typically, they could not recover even from a minor illness.<br>
	9 - Terminally III – Approaching the end of life. This category applies to people with a life expectancy &lt; 6 months, who are not otherwise evidently frail.<br><br>
	Copyright for the Clinical Fragility Scale obtained from Dalhousie University (2021)
	</span>
</div>
</div>
<!-- script to run the accordion -->
<script>
	var acc = document.getElementsByClassName("accordion");
	var i;

	for (i = 0; i < acc.length; i++) {
	  acc[i].addEventListener("click", function() {
		this.classList.toggle("active");
		var panel = this.nextElementSibling;
		if (panel.style.maxHeight) {
		  panel.style.maxHeight = null;
		} else {
		  panel.style.maxHeight = panel.scrollHeight + "px";
		} 
	});
	}
</script>



<!--  -----------Pop-up end----------------------- -->
<!-- Define Date Calendars -->
<script type="text/javascript">
	Calendar.setup( { inputField : "today", ifFormat : "%d/%m/%Y",  button : "today" } );
</script>
<!-- Xbox and Radio scripts -->
<script>
var b = document.getElementsByClassName("Xbox");
// console.log("Xboxes: "+b.length);
for(var i=0; i<b.length; i++){ 
 b[i].onclick = function(){ 
   //console.log("click on " + this.id); 
// large black box is '\u2B1B' does not render or save properly on all systems
  if (document.getElementById(this.id).value.length < 1) {
	document.getElementById(this.id).value = 'X' ;
	} else {
	document.getElementById(this.id).value ='';
	}
  return false;
}
 } 

var r = document.getElementsByClassName("Radio");
//console.log("Radio array length is "+r.length);
for(var i=0; i<r.length; i++){

 r[i].onclick = function(){ 
	let x = this.id;

   var partA = x.substring(0, x.indexOf("_"));
   let items = document.querySelectorAll("[id^='"+partA+"_']");
   //console.log("click on " + x + " in a group of " +items.length); 
     for(let item of items){
    if (x != item.id) { 
		item.value = ''; 
	} else {
		document.getElementById(x).value ='X';
	}
  }

 } 
} 
</script>

</body>
</html>